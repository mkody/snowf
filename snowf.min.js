!function(t,n){"object"==typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define(n):t.snowf=n()}(this,function(){var n={},h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||function(t){window.clearTimeout(t)},i={dom:document.body,onWindow:!1,amount:50,size:5,speed:1.5,wind:0,color:"#fff",opacity:.8,swing:1,image:null,zIndex:null};function e(t){this.options=o({},i,n,t)}function o(){for(var t=arguments,n=1,i=t.length;n<i;n++)for(var e in t[n])t[0][e]=t[n][e];return t[0]}function s(t,n){return o(t.style,n)}function c(t,n){var i=n-t;return n===t?t:Math.random()*i+t}return e.prototype.init=function(){if(this.canvas)return this;var t,n=this.options;return this.dom="string"===(t=n.dom,Object.prototype.toString.call(t).toLowerCase().match(/\[object (\S*)\]/)[1])?document.querySelector(n.dom):n.dom,this.canvas=function(t,n){var i,e=document.createElement(t);for(i in n)e[i]=n[i];return e}("canvas",{className:"snowf-canvas"}),s(this.canvas,{position:n.onWindow?"fixed":"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"}),n.zIndex&&s(this.canvas,{zIndex:n.zIndex}),this.dom.appendChild(this.canvas),this.height=this.canvas.height=this.canvas.offsetHeight,this.width=this.canvas.width=this.canvas.offsetWidth,this.context=this.canvas.getContext("2d"),this.flakes=[],this.animationFrame=null,this.reset()},e.prototype.reset=function(){var e=this,o=e.options,s=(e.dom,e.canvas,e.context),a=e.flakes=[];function r(){var t;s.clearRect(0,0,e.width,e.height);for(var n=0;n<o.amount;n++){var i=a[n];o.image?(t||((t=new Image).src=o.image),s.drawImage(t,i.x-i.r,i.y-i.r,2*i.r,2*i.r)):(s.beginPath(),s.fillStyle="rgba("+function(t){var n="";n=0===t.indexOf("#")?4===t.length?t.substr(1).split("").map(function(t){return parseInt(t.concat(t),16)}).join(","):7===t.length?[t.substr(1,2),t.substr(3,2),t.substr(5,2)].map(function(t){return parseInt(t,16)}).join(","):"255,255,255":0===t.indexOf("rgb(")?t.substring(4,t.length-1):"255,255,255";return n}(o.color)+","+i.opacity+")",s.arc(i.x,i.y,i.r,2*Math.PI,!1),s.fill(),s.closePath()),i.velX=Math.abs(i.velX)<Math.abs(o.wind)?i.velX+o.wind/20:o.wind,i.y=i.y+.5*i.velY,i.x=i.x+(o.swing?.4*Math.cos(i.swing+=.03)*i.opacity*o.swing:0)+.5*i.velX,(i.x>e.width+i.r||i.x<-i.r||i.y>e.height+i.r||i.y<-i.r)&&function(t){var n=t.r;t.r=c(o.size,2*o.size)/2,t.x>e.width+n?(t.x=-t.r,t.y=c(0,e.height)):t.x<-n?(t.x=e.width+t.r,t.y=c(0,e.height)):(t.x=c(0,e.width),t.y=-t.r);t.velX=0,t.velY=c(o.speed,2*o.speed),t.swing=c(0,2*Math.PI),t.opacity=c(0,o.opacity)}(i)}e.animationFrame=h(r)}return t(e.animationFrame),function(){for(var t=0;t<o.amount;t++)a.push({x:c(0,e.width),y:c(0,e.height),r:c(o.size,2*o.size)/2,velX:0,velY:c(o.speed,2*o.speed),swing:c(0,2*Math.PI),opacity:c(0,o.opacity)});r()}(),this},e.prototype.setOptions=function(t){return o(this.options,t),this.reset()},e.prototype.wind=function(t,n){var i=this.options,e=i.wind;return i.wind=t,n&&setTimeout(function(){i.wind=e},n),this},e.prototype.speed=function(t){var n=this.options,i=n.speed;n.speed=t;for(var e=0;e<n.amount;e++)this.flakes[e].velY*=t/i;return this},e.prototype.resize=function(){var t=this.options,n=this.canvas.height,i=this.canvas.width,e=t.onWindow?window.innerHeight:this.dom.offsetHeight,o=t.onWindow?window.innerWidth:this.dom.offsetWidth;this.canvas.height=this.height=e,this.canvas.width=this.width=o;for(var s=0;s<t.amount;s++){var a=this.flakes[s];a.x=a.x/i*o,a.y=a.y/n*e}return this},{version:"0.0.3",init:function(t){return new e(t).init()},config:function(t){n=t}}});